{% extends '../base/base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'ongeki_op/style.css' %}">
<!-- Content Wrapper. Contains page content -->
<div class="container">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid pl-0">
            <div class="row mb-2">
                <div class="col">
                    <h1 class="m-0">オンゲキ版OVERPOWER</h1>
                </div><!-- /.col -->
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">

            {% if is_beta %}
            {% include "../common/info_alert.html" %}
            {% endif %}

            <!-- ここにいろいろ書く -->
            <div class="row">
                <div class="col">
                    <div class="card card-primary card-outline">

                        <div class="card-header">
                            <h3 class="card-title">O.N.G.E.K.I. POWER</h3>
                        </div>

                        <div class="card-body">

                            <div class="row justify-content-center">
                                <div class="col-12 col-md-10">

                                    <div class="row justify-content-center align-items-center mb-3">

                                        <div class="col-auto">
                                            <div class="input-group mb-1">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text">OngekiScoreLog ID</span>
                                                </div>
                                                <input type="text" class="form-control text-center" placeholder="xxxx"
                                                    value="" id="osl-id" />
                                                <div class="input-group-append">
                                                    <button class="btn btn-primary" type="button"
                                                        id="calc-button">実行</button>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="row justify-content-center align-items-center">

                                        <div class="col-auto">
                                            <div class="form-group">
                                                <label for="classification">分類</label>
                                                <select class="form-control" id="classification">
                                                    <option value="1">ジャンル順</option>
                                                    <option value="2">バージョン順</option>
                                                    <option value="0">レベル順</option>
                                                    <option value="3">定数順</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="form-group">
                                                <label for="display-format">表示形式</label>
                                                <select class="form-control" id="display-format">
                                                    <option value="0">通常</option>
                                                    <option value="1">通常(FB割合非表示)</option>
                                                    <option value="2" disabled>スコアランク割合のみ一覧表示</option>
                                                </select>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row justify-content-center align-items-center">
                                        <div class="col-auto">
                                            <p>設定変更後は再度実行してください。</p>
                                        </div>
                                    </div>
                                    <div class="row justify-content-center align-items-center">
                                        <div class="col-auto">
                                            <p><a href="#calc-details">計算式について ▼</a></p>
                                        </div>
                                    </div>

                                    <hr />

                                    <i id="loading-text" style="display: none;"
                                        class="ml-2 fas fa-spinner fa-pulse"></i>

                                    <!-- 概要 -->
                                    <div id="op_summary">
                                        <!-- <div class="row mb-3 justify-content-center align-items-center">

                                            <div class="col-auto">
                                                <h5 class="mt-2 mb-2 text-center">O.N.G.E.K.I. POWER</h5>
                                                <div class="possession-color">
                                                    <h2 class="mb-2 text-center pc-rainbow"><span id="result-hi">100</span><span
                                                            id="result-lo">.0000%</span></h2>
                                                </div>
                                                <h5 class="mb-3 text-center">99999.99/99999.99</h5>
                                                <p class="mb-3 text-center">Player: △Natua♪▽ [17.00/17.00]</p>
                                            </div>


                                        </div> -->
                                    </div>


                                    <!-- 個別 -->
                                    <hr />
                                    <div id="op_card"></div>
                                    <!-- <div class="row mb-3">
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-body">
                                                    <div class="row justify-content-end align-items-center">
                                                        <div class="col-auto h3">ALL</div>
                                                        <div class="col"></div>
                                                        <div class="col-auto h3">100.0000%</div>
                                                        <div class="col-auto h5">[ 99999.99/99999.99 ]</div>
                                                    </div>
                                                    <hr>
                                                    <div class="row mb-1">
                                                        <div class="col-4">P: 999</div>
                                                        <div class="col-4">SSS+: 999</div>
                                                        <div class="col-4">SSS: 999</div>
                                                        <div class="col-4">SS: 999</div>
                                                        <div class="col-4">S: 999</div>
                                                        <div class="col-4">Others: 999</div>
                                                    </div>
                                                    <div class="row mb-2">
                                                        <div class="col">
                                                            <div class="overpower-graph-base">
                                                                <div class="bg-white" style="width: 20%;"></div>
                                                                <div class="bg-platinum" style="width:40%"></div>
                                                                <div class="bg-gold" style="width:60%"></div>
                                                                <div class="bg-silver" style="width:80%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-1">
                                                        <div class="col-6">P: 999</div>
                                                        <div class="col-6">AB: 999</div>
                                                        <div class="col-6">FC: 999</div>
                                                        <div class="col-6">Others: 999</div>
                                                    </div>
                                                    <div class="row mb-2">
                                                        <div class="col">
                                                            <div class="overpower-graph-base">
                                                                <div class="bg-white" style="width: 20%;"></div>
                                                                <div class="bg-platinum" style="width:40%"></div>
                                                                <div class="bg-gold" style="width:60%"></div>
                                                                <div class="bg-silver" style="width:80%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-1">
                                                        <div class="col-6">FB: 999</div>
                                                        <div class="col-6">Others: 999</div>
                                                    </div>
                                                    <div class="row mb-2">
                                                        <div class="col">
                                                            <div class="overpower-graph-base">
                                                                <div class="bg-white" style="width: 20%;"></div>
                                                                <div class="bg-platinum" style="width:40%"></div>
                                                                <div class="bg-gold" style="width:60%"></div>
                                                                <div class="bg-silver" style="width:80%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->


                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="card card-primary card-outline" id="calc-details">

                        <div class="card-header">
                            <h3 class="card-title">計算式について</h3>
                        </div>

                        <div class="card-body">

                            <div class="row justify-content-center">

                                <div class="col-12 col-md-10">
                                    <p>CHUNITHMのOPと同じ計算式を採用しています。ただし、対象曲はMASTER譜面のみです。</p>
                                    <p>各楽曲のMASTER譜面ごとに単曲OPを計算します。それらの総和がプレイヤーのOPとなります。</p>
                                    <p>単曲OPは以下の式で計算されます。<br>※ランプ補正: FC=0.5, AB=1.0, AB+=1.25</p>
                                    <p style="text-align:center;">単曲OP = min(譜面定数+2,単曲レート)*5 + ランプ補正 +
                                        max(0,(Tスコア-1007500)*0.0015) </p>
                                    <p>AB+達成時の単曲OPは (定数+3)*5 となり、これが単曲OPの最大値となります。</p>
                                    <p>プレイヤーOPの背景色は、99.62%で虹、98.85%でプラチナ、97.50%で金色になります。</p>

                                </div>

                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
</div>

</div><!-- /.container-fluid -->
</section>
<!-- /.content -->
</div>
<script>
    var csrfmiddlewaretoken = "{{ csrf_token }}"
    var send_url = '{% url "my_apps:ongeki_op_page" %}'
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="{% static 'ongeki_op/script.js' %}"></script>
{% endblock content %}
